<div style="width: 90%; padding-left: 75px;">

{% assign service_count = 0 %}
{% assign path_count = 0 %}
{% assign apijson = site.data.apis %}
{% assign contents = site.data.api-commons %}

{% for api in apijson.include %}

  {% assign path = api.url  | replace: site.raw_url,'' %}
  {% assign path = path  | replace: '/apis.yaml','' %}

  {% for api in contents %}

    {% assign api_name = api[0] %}
    {% assign folder = api[1] %}

    {% if api_name == path %}

      <!--- Begin --->

      {% for item in folder %}

        {% assign item_name = item[0] %}

        {% if item_name == 'apis' %}

          {% assign apijson = item[1] %}

          {% assign api_name = apijson.name %}
          {% assign api_description = apijson.description %}
          {% assign api_image = apijson.image %}
          {% assign api_json_url = apijson.url %}

          {% assign api_json_kin_rank = apijson.x-kinRank %}
          {% assign api_json_alexa_rank = apijson.x-alexaRank %}

          {% assign blog_url = '' %}
          {% assign blogrss_url = '' %}
          {% assign portal_url = '' %}
          {% assign gitub_url = '' %}
          {% assign twitter_url = '' %}
          {% assign website_url = '' %}
          {% assign getting_started_url = '' %}
          {% assign authentication_url = '' %}
          {% assign faq_url = '' %}
          {% assign login_url = '' %}
          {% assign signup_url = '' %}
          {% assign documentation_url = '' %}
          {% assign code_page_url = '' %}
          {% assign road_map_url = '' %}
          {% assign issue_url = '' %}
          {% assign change_log_url = '' %}
          {% assign status_dashboard_url = '' %}
          {% assign support_url = '' %}
          {% assign plan_url = '' %}
          {% assign rate_limit_url = '' %}
          {% assign terms_of_service_url = '' %}
          {% assign privacy_policy_url = '' %}

          {% for common in apijson.x-common %}

            {% if common.type == 'x-portal' %}
              {% assign portal_url = common.url %}
            {% endif %}

            {% if common.type == 'x-website' %}
              {% assign website_url = common.url %}
            {% endif %}

            {% if portal_url == '' %}
              {% assign portal_url = website_url %}
            {% endif %}

            {% if common.type == 'x-getting-started' %}
              {% assign getting_started_url = common.url %}
            {% endif %}
            {% if common.type == 'x-authentication-overview' %}
              {% assign authentication_url = common.url %}
            {% endif %}
            {% if common.type == 'x-faq' %}
              {% assign faq_url = common.url %}
            {% endif %}

            {% if common.type == 'x-login' %}
              {% assign login_url = common.url %}
            {% endif %}

            {% if common.type == 'x-selfservice-registration' %}
              {% assign signup_url = common.url %}
            {% endif %}

            {% if common.type == 'x-documentation' %}
              {% assign documentation_url = common.url %}
            {% endif %}

            {% if common.type == 'x-code-page' %}
              {% assign code_page_url = common.url %}
            {% endif %}

            {% if common.type == 'x-road-map' %}
              {% assign road_map_url = common.url %}
            {% endif %}
            {% if common.type == 'x-issues' %}
              {% assign issue_url = common.url %}
            {% endif %}
            {% if common.type == 'x-change-log' %}
              {% assign change_log_url = common.url %}
            {% endif %}
            {% if common.type == 'x-status' %}
              {% assign status_dashboard_url = common.url %}
            {% endif %}

            {% if common.type == 'x-support' %}
              {% assign support_url = common.url %}
            {% endif %}

            {% if common.type == 'x-blog' %}
              {% assign blog_url = common.url %}
            {% endif %}

            {% if common.type == 'x-blog-rss' %}
              {% assign blogrss_url = common.url %}
            {% endif %}

            {% if common.type == 'x-twitter' %}
              {% assign twitter_url = common.url %}
            {% endif %}

            {% if common.type == 'x-github' %}
              {% assign gitub_url = common.url %}
            {% endif %}

            {% if common.type == 'x-signup' %}
              {% assign gitub_url = common.url %}
            {% endif %}

            {% if common.type == 'x-dedicated-plans--pricing-page' %}
              {% assign plan_url = common.url %}
            {% endif %}
            {% if common.type == 'x-rate-limit' %}
              {% assign rate_limit_url = common.url %}
            {% endif %}

            {% if common.type == 'x-terms-of-service-page' %}
              {% assign terms_of_service_url = common.url %}
            {% endif %}
            {% if common.type == 'x-privacy-policy-page' %}
              {% assign privacy_policy_url = common.url %}
            {% endif %}

          {% endfor %}

          {% if api_json_kin_rank == '8' or api_json_kin_rank == '9' %}
              {% assign service_count = service_count | plus: 1 %}
              <!--<p><img src="{{ api_image }}" width="100" style="padding: 10px;" align="left" /></p>-->
              <p>
                <span style="font-size: 18px; font-weight: bold">{{ api_name }}</span> (<a href="{{ api_json_url }}" target="_blank" title="View OpenAPI" style="font-size: 16px; font-weight: normal;">APIs.json</a>)
                <br />{{ api_description }}
              </p>
              <p><span style="font-size: 16px; font-weight: bold">Key Links</span></p>
              <ul>
                {% if portal_url != '' %}
                  <li>
                    <a href="{{ portal_url }}" target="_blank" title="Portal">Website</a>
                  </li>
                {% endif %}
                {% if blog_url != '' && blog_url != empty && blog_url != null %}
                  <li>
                    <a href="{{ blog_url }}" target="_blank" title="Blog">Blog</a>
                  </li>
                {% endif %}

                {% if blogrss_url != '' && blogrss_url != empty && blogrss_url != null %}
                  <li>
                    <a href="{{ blogrss_url }}" target="_blank" title="Blog RSS">Blog RSS</a>
                  </li>
                {% endif %}

                {% if twitter_url != '' && twitter_url != empty && twitter_url != null %}
                  <li>
                    <a href="{{ twitter_url }}" target="_blank" title="Twitter">Twitter</a>
                  </li>
                {% endif %}

                {% if gitub_url != '' && gitub_url != empty && gitub_url != null %}
                  <li>
                    <a href="{{ gitub_url }}" target="_blank" title="Github">Github</a>
                  </li>
                {% endif %}

              </ul>
            {% assign api_action_url = '' %}
            {% assign numberofapis = apijson.apis | size %}

            {% if numberofapis > 0 %}
                    {% for api in apijson.apis %}

                      {% for property in api.properties %}

                        {% assign openapi_spec_url = "" %}
                        {% if property.type == 'x-openapi-spec' %}
                          {% assign openapi_spec_url = property.url %}
                        {% endif %}

                      {% endfor %}

                      <p><span style="font-size: 16px; font-weight: bold">API Details</span>{% if openapi_spec_url != null and openapi_spec_url != empty %} (<a href="{{ openapi_spec_url }}" target="_blank" title="View OpenAPI" style="font-size: 16px; font-weight: normal;">OpenAPI</a>){% endif %}</p>

                      {% assign openapi_spec_url = openapi_spec_url  | replace: site.raw_url,'' %}
                      {% assign openapi_spec_url_array = openapi_spec_url | split: '/' %}
                      {% assign openapi_spec_url = openapi_spec_url_array[0] %}

                      {% assign openapi_spec = '' %}
                      {% for item in contents %}
                        {% if openapi_spec_url == item[0] %}
                          {% assign openapi_spec_content = item[1] %}
                        {% endif %}
                      {% endfor %}

                      <ul>
                      {% for entry in openapi_spec_content %}
                        {% for path in entry[1].paths %}
                          {% assign display_path = path[0] %}
                          {% assign path_details = path[1] %}
                          {% for method in path_details %}
                            {% assign verb = method[0] %}
                            {% assign method_details = method[1] %}
                            {% assign summary = method_details.summary %}
                            {% assign description = method_details.description %}
                          {% endfor %}
                          <li><strong>{{ summary }}</strong> {{ display_path }} (<i>GET</i>) - {{ description }}</li>
                        {% endfor %}
                      {% endfor %}
                      </ul>

                      {% assign taglist = '' %}
                      {% for entry in openapi_spec_content %}
                        {% for path in entry[1].paths %}

                          {% assign this_path = path[0] %}
                          {% assign method_json = path[1] %}

                          {% for method in method_json %}
                            {% assign tagarray = method[1].tags %}
                            {% for tag in tagarray %}
                              {% if taglist contains tag %}
                              {% else %}
                                {% assign taglist = taglist | append: "," %}
                                {% assign taglist = taglist | append: tag %}
                              {% endif %}
                            {% endfor %}
                          {% endfor %}

                        {% endfor %}
                      {% endfor %}
                      {% assign tag_cloud = taglist | split: "," %}
                      {% assign tag_cloud = tag_cloud | sort: "" %}
                      <p><span style="font-size: 16px; font-weight: bold">Tags</span><br />
                      {% for tag in tag_cloud %}{% if forloop.first != true %}{{ tag }}{% if forloop.last != true %}, {% endif %}{% endif %}{% endfor %}
                      </p>

                    {% endfor %}

            {% endif %}
            <hr />
            {% endif %}

        {% endif %}
      {% endfor %}

    {% endif %}

  {% endfor %}

{% endfor %}

</div>
